<div class="bg-background3 rounded-lg p-3 mb-4">
  <div class="flex justify-between text-lg mb-2 pb-2">
    <h3 class="">Lista de ejercicios:</h3>
    <p class="text-text2 rounded-2xl bg-background2 px-3">
      Cantidad: {{ this.facade.exercisesSelected().length }}
    </p>
  </div>

  <div class="flex flex-col gap-2">
    @for (exercise of this.facade.exercisesWorkout(); track exercise.exerciseId) {
      <app-accordion-item
        [title]="exercise.name"
        [open]="open(exercise.exerciseId!)"
        [isSelected]="false"
        (toggle)="toggleAccordion(exercise.exerciseId!)"
      >
        <div class="space-y-3">
          <!-- Sets display -->
          @for (set of getSets(exercise); track $index; let i = $index) {
            <div
              class="flex items-center justify-between gap-2 py-3 bg-background2 border-b border-primary"
              [class.border-b-0]="i === getSets(exercise).length - 1"
            >
              <!-- Set number -->
              <div
                class="flex-shrink-0 w-6 h-6 rounded-full bg-background flex items-center justify-center"
              >
                <span class="text-brand font-semibold">{{ i + 1 }}</span>
              </div>

              <!-- Reps input -->
              <div class="flex items-center gap-1">
                <label class="text-sm text-text2">REPS</label>
                <div class="flex items-center gap-1">
                  <button
                    (click)="decrementReps(exercise.exerciseId!, i)"
                    class="w-6 h-6 rounded-full bg-background3 hover:bg-background3/80 flex items-center justify-center text-text2"
                  >
                    <span class="text-lg">−</span>
                  </button>
                  <input
                    type="number"
                    [value]="set.reps"
                    (input)="updateReps(exercise.exerciseId!, i, $event)"
                    class="w-12 h-6 px-2 bg-background3 border border-background3 text-heading text-center rounded-lg focus:ring-brand focus:border-brand [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none"
                  />
                  <button
                    (click)="incrementReps(exercise.exerciseId!, i)"
                    class="w-6 h-6 rounded-full bg-background flex items-center justify-center text-white"
                  >
                    <span class="text-lg">+</span>
                  </button>
                </div>
              </div>

              <!-- Weight input (if uses weight) -->
              @if (exercise.usesWeight) {
                <div class="flex items-center gap-2">
                  <label class="text-sm text-text2">PESO</label>
                  <div class="flex items-center gap-1">
                    <button
                      (click)="decrementWeight(exercise.exerciseId!, i)"
                      class="w-6 h-6 rounded-full bg-background3 hover:bg-background3/80 flex items-center justify-center text-text2"
                    >
                      <span class="text-lg">−</span>
                    </button>
                    <div class="flex items-center gap-1">
                      <input
                        type="number"
                        step="2.5"
                        [value]="set.weights"
                        (input)="updateWeight(exercise.exerciseId!, i, $event)"
                        class="w-12 h-6 px-2 bg-background3 border border-background3 text-heading text-center rounded-lg focus:ring-brand focus:border-brand [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none"
                      />
                      <span class="text-sm text-text2">kg</span>
                    </div>
                    <button
                      (click)="incrementWeight(exercise.exerciseId!, i)"
                      class="w-6 h-6 rounded-full bg-background flex items-center justify-center text-white"
                    >
                      <span class="text-lg">+</span>
                    </button>
                  </div>
                </div>
              }
              <!-- <hr class="border border-primary" /> -->
            </div>
          }

          <!-- Add/Remove set buttons -->
          <div class="flex gap-2 mt-3">
            <button
              (click)="removeSet(exercise.exerciseId!)"
              class="flex-1 py-2 px-4 bg-background3 hover:bg-background2/80 text-text2 rounded-lg text-sm"
            >
              − Serie
            </button>
            <button
              (click)="addSet(exercise.exerciseId!)"
              class="flex-1 py-2 px-4 bg-background text-brand rounded-lg text-sm"
            >
              + Serie
            </button>
          </div>
        </div>
      </app-accordion-item>
    }
  </div>
</div>
